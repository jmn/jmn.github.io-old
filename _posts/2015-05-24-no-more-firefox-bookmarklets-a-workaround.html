---
title: "No more Firefox bookmarklets: A workaround"
layout: "post"
CATEGORY: "???"
ON: "2015-05-24 02:48"
---

<p>
There is a bug[<a href="#866522_bookmarklets_affected_csp">1</a>] preventing bookmarklets from working correctly in Firefox. To work around this bug, it is possible to use extensions, which can execute all (including potentially unsafe) browser code. One option is to use the "Custom buttons" extension[<a href="#custom_buttons_addons_firefox">2</a>] and create custom buttons which execute your Javascript code.
</p>

<p>
My example case:
In my .keysnailrc I have this function:
</p>

<div class="org-src-container">


{% syntax javascript %}
ext.add("bookmark-with-org",
        function (aEvent, aArg) {
          var od = window.content.document;
          window.loadURI('org-protocol://capture://f/'+encodeURIComponent(od.location.href)+'/'+encodeURIComponent(od.title)+'/'+encodeURIComponent(window.content.getSelection()));
}, M({en: "Save bookmark in Emacs org-mode using org-protocol"}));

{% endsyntax %}
</div>

<p>
Running the function sends a bookmark to Emacs org-mode capture.
</p>

<p>
To call the function from a custom button, I use this code:
</p>
<div class="org-src-container">


{% syntax javascript %}
window.KeySnail.modules.ext.exec("bookmark-with-org",null);

{% endsyntax %}
</div>

<div id="bibliography">
<h2>References</h2>

</div>
<table>

<tr valign="top">
<td align="right" class="bibtexnumber">
[<a name="866522_bookmarklets_affected_csp">1</a>]
</td>
<td class="bibtexitem">
866522 â€“ bookmarklets affected by CSP.
[&nbsp;<a href="notes_bib.html#866522_bookmarklets_affected_csp">bib</a>&nbsp;| 
<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=866522">http</a>&nbsp;]

</td>
</tr>


<tr valign="top">
<td align="right" class="bibtexnumber">
[<a name="custom_buttons_addons_firefox">2</a>]
</td>
<td class="bibtexitem">
Custom buttons :: Add-ons for firefox.
[&nbsp;<a href="notes_bib.html#custom_buttons_addons_firefox">bib</a>&nbsp;| 
<a href="https://addons.mozilla.org/en-US/firefox/addon/custom-buttons/">http</a>&nbsp;]

</td>
</tr>
</table>
