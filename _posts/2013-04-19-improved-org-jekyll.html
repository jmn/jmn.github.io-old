---
title: Improved org-jekyll
layout: post
on: <2013-04-19 Fri>
ex: (For my purposes anyway.)
tags: meta jekyll
CATEGORY: journal
---


<p>
I've been tweaking org-jekyll for my purposes. Headings in my org-mode journal (usually) contain a timestamp in brackets and org-jekyll wasn't set up to handle that (which resulted in bad file names and post titles). I <a href="http://stackoverflow.com/a/2403159/41829">used a regexp</a> to solve this. (<a href="http://www.emacswiki.org/emacs/RegularExpression">more on Emacs and regular expressions here)</a>:
</p>

<div class="org-src-container">

<pre class="src src-elisp">(title (replace-regexp-in-string <span style="color: #8b2252;">"-\\[.*?\\]"</span> <span style="color: #8b2252;">""</span>
                                             (replace-regexp-in-string
                                              <span style="color: #8b2252;">"[ \t]"</span> <span style="color: #8b2252;">"-"</span> heading)))
</pre>
</div>

<p>
I also  set it up so that the org properties "excerpt" and "tags" are now carried over to YAML, like so:
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp">(<span style="color: #a020f0;">defun</span> <span style="color: #0000ff;">org-jekyll-export-entry</span> (project)
  (<span style="color: #a020f0;">let*</span> ((props (org-entry-properties nil 'standard))
         (time (cdr (or (assoc <span style="color: #8b2252;">"on"</span> props)
                        (assoc <span style="color: #8b2252;">"ON"</span> props))))
         (excerpt (cdr (or (assoc <span style="color: #8b2252;">"excerpt"</span> props)
                        (assoc <span style="color: #8b2252;">"EXCERPT"</span> props))))
         (excerpt (cdr (or (assoc <span style="color: #8b2252;">"tags"</span> props)
                        (assoc <span style="color: #8b2252;">"TAGS"</span> props))))
         (lang (cdr (or (assoc <span style="color: #8b2252;">"lang"</span> props)
                        (assoc <span style="color: #8b2252;">"LANG"</span> props))))
         (category (<span style="color: #a020f0;">if</span> org-jekyll-category
                       (cdr (assoc org-jekyll-category props))
                     nil))
...
</pre>
</div>

<p>
I must say it was pretty easy to get a nice set up going using Jekyll Bootstrap and and org-jekyll, and I'm already quite happy with the result. Posts are now looking okay but it's still not 100% convenient to add a new post. I am thinking of modifying org-jekyll so that the "on" property is not required if there exists a timestamp in the title. I am also thinking of making it possible to have the tags from emacs transfer over to YAML and Jekyll. 
</p>

<p>
Another small annoyance is that posting does not seem to work directly from the org capture buffer. This might be understandably hard to and the pay off not that great.
</p>

<p>
Yet Another potential annoyance is that Jekyll seems to be (notoriously?) poor at detecting file changes and therefore local server restarts are often required to review posts before they are pushed to the Github servers.
</p>

<p>
Another thing that needs fixing is linking to static assets with relative filepaths.) 
</p>

<p>
Or rather, how to configure org-publish so that "./static/coffee.jpg" in org becomes "/static/coffee.jpg" in HTML.
</p>

<p>
But that is a headache better left for other days. For now I'm having a coffee.
</p>


<div class="figure">
<p><img src="http://jmn.github.io/static/coffee.jpg"  alt="coffee.jpg"/></p>
</div>
